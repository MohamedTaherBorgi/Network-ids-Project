Why capture modules avoid writing CSV

Capture must be fast → no disk I/O.

They must be reusable by real-time IDS pipelines.

CSV storage is optional and configurable.

Responsibilities must stay separated (clean architecture).

| File                     | Should write CSV? | Reason                       |
| ------------------------ | ----------------- | ---------------------------- |
| **scapy_capture.py**     | ❌ No              | Only captures packets        |
| **pyshark_capture.py**   | ❌ No              | Only captures packets        |
| **feature_extractor.py** | ✔ Yes (optional)  | Extracts structured data     |
| **main.py**              | ✔ Yes (common)    | Orchestrates entire pipeline |
| **train_model.py**       | ✔ Yes             | Uses deep_packets.csv        |


1. ScapyCapture and PysharkCapture

→ only capture packets
→ return a normalized dict
→ do not save anything
→ do not know about CSV

2. capture_engine.py

→ receives normalized packets
→ writes raw logs to captured_packets.csv
→ converts packets using feature_extractor
→ writes ML features to deep_packets.csv
→ is the ONLY place that writes CSVs

| Teacher Task                            | Which CSV it corresponds to       |
| --------------------------------------- | --------------------------------- |
| 2. “Capture + stockage de paquets”      | captured_packets.csv              |
| 4. “Détection d’anomalies + validation” | deep_packets.csv                  |
| 3. “Moteur signatures”                  | captured_packets.csv (raw values) |
| 4. “ML anomalies”                       | deep_packets.csv (features)       |
| Debugging + reporting                   | captured_packets.csv              |
| Model training                          | deep_packets.csv                  |
